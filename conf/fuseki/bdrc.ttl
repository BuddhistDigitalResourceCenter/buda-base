# Fuseki configuration for BDRC, configures two endpoints:
#   - /bdrc is read-only
#   - /bdrcrw is read-write
#
# This was painful to come up with but the web interface basically allows no option
# and there is no subclass inference by default so such a configuration file is necessary.
#
# The main doc sources are:
#  - https://jena.apache.org/documentation/fuseki2/fuseki-configuration.html
#  - https://jena.apache.org/documentation/assembler/assembler-howto.html
#  - https://jena.apache.org/documentation/assembler/assembler.ttl
#
# See https://jena.apache.org/documentation/fuseki2/fuseki-layout.html for the destination of this file.

@prefix fuseki:  <http://jena.apache.org/fuseki#> .
@prefix rdf:     <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs:    <http://www.w3.org/2000/01/rdf-schema#> .
@prefix tdb:     <http://jena.hpl.hp.com/2008/tdb#> .
@prefix ja:      <http://jena.hpl.hp.com/2005/11/Assembler#> .
@prefix :        <http://base/#> .

:bdrcrw rdf:type fuseki:Service ;
	rdfs:label						  "BDRC Read Write" ;
    fuseki:name                       "bdrcrw" ;     # name of the dataset in the url
    fuseki:serviceQuery               "query" ;    # SPARQL query service
    fuseki:serviceQuery               "sparql" ;   # SPARQL query service
    fuseki:serviceUpdate              "update" ;   # SPARQL query service
    fuseki:serviceUpload              "upload" ;   # Non-SPARQL upload service
    fuseki:serviceReadWriteGraphStore "data" ;     # SPARQL Graph store protocol (read and write)
    # A separate read-only graph store endpoint:
    fuseki:serviceReadGraphStore      "get" ;      # SPARQL Graph store protocol (read only)
    fuseki:dataset                    :dataset_bdrc ;
    .

:bdrcro rdf:type fuseki:Service ;
    fuseki:name                     "bdrc" ;
    fuseki:serviceQuery             "query" ;
    fuseki:serviceReadGraphStore    "data" ;
    fuseki:dataset           		:dataset_bdrc ;
    .

:dataset_bdrc rdf:type       ja:RDFDataset ;
#    ja:defaultGraph          :model_inf ;
    ja:defaultGraph          :tdbGraph ;
    .

#:model_inf a ja:OntModel ;
#	 rdfs:label "BDRC Inf model (OWLFBRuleReasoner)" ;
#     ja:baseModel :tdbGraph ;
#     ja:prefixMapping :pm ;
#     # not sure about the following line, seems to work without it
#     ja:ontModelSpec ja:OWL_DL_MEM_RULE_INF ;
#     ja:reasoner [
#     	# This url looks outdated, but it works...
#        ja:reasonerURL <http://jena.hpl.hp.com/2003/OWLFBRuleReasoner>
#     ] .

:tdbGraph rdf:type tdb:GraphTDB ;
    tdb:dataset :tdbDataset .

:tdbDataset rdf:type tdb:DatasetTDB ;
    tdb:location "/etc/fuseki/databases/bdrc" ;
    # If the unionDefaultGraph is used, then the "update" service should be removed.
    # tdb:unionDefaultGraph true ;
    .

# These prefix mappings don't seem to do anything...

#:pm rdf:type ja:PrefixMapping ;
#	ja:includes :pm0 ;
#    ja:includes :pm1 ;
#    ja:includes :pm2 ;
#    ja:includes :pm3 ;
#    ja:includes :pm4 ;
#    ja:includes :pm5 ;
#    ja:includes :pm6 ;
#    ja:includes :pm7 ;
#    ja:includes :pm8 ;
#    ja:includes :pm9 ;
#    ja:includes :pm10 ;
#    ja:includes :pm11 ;
#	.
#
#:pm0 rdf:type ja:SinglePrefixMapping; 
#	ja:prefix ''; 
#	ja:namespace 'http://purl.bdrc.io/ontology/root/' ;
#	.
#
#:pm1 rdf:type ja:SinglePrefixMapping; 
#	ja:prefix 'crp'; 
#	ja:namespace 'http://purl.bdrc.io/ontology/corporation#' ;
#	.
#
#:pm2 rdf:type ja:SinglePrefixMapping; 
#	ja:prefix 'prd'; 
#	ja:namespace 'http://purl.bdrc.io/ontology/product#' ;
#	.
#
#:pm3 rdf:type ja:SinglePrefixMapping; 
#	ja:prefix 'out'; 
#	ja:namespace 'http://purl.bdrc.io/ontology/outline#' ;
#	.
#
#:pm4 rdf:type ja:SinglePrefixMapping; 
#	ja:prefix 'plc'; 
#	ja:namespace 'http://purl.bdrc.io/ontology/place#' ;
#	.
#
#:pm5 rdf:type ja:SinglePrefixMapping; 
#	ja:prefix 'ofc'; 
#	ja:namespace 'http://purl.bdrc.io/ontology/office#' ;
#	.
#
#:pm6 rdf:type ja:SinglePrefixMapping; 
#	ja:prefix 'lin'; 
#	ja:namespace 'http://purl.bdrc.io/ontology/lineage#' ;
#	.
#
#:pm7 rdf:type ja:SinglePrefixMapping; 
#	ja:prefix 'top'; 
#	ja:namespace 'http://purl.bdrc.io/ontology/topic#' ;
#	.
#
#:pm8 rdf:type ja:SinglePrefixMapping; 
#	ja:prefix 'wor'; 
#	ja:namespace 'http://purl.bdrc.io/ontology/work#' ;
#	.
#
#:pm9 rdf:type ja:SinglePrefixMapping; 
#	ja:prefix 'vol'; 
#	ja:namespace 'http://purl.bdrc.io/ontology/volumes#' ;
#	.
#
#:pm10 rdf:type ja:SinglePrefixMapping; 
#	ja:prefix 'desc'; 
#	ja:namespace 'http://onto.bdrc.io/ontology/description#' ;
#	.
#
#:pm11 rdf:type ja:SinglePrefixMapping; 
#	ja:prefix 'per'; 
#	ja:namespace 'http://purl.bdrc.io/ontology/person#' ;
#	.
